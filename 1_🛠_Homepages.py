import streamlit as st
from easy_ernie import FastErnie
fastErnie=''


st.title("🙂 welcome to gpt")

if "BAIDUID" not in st.session_state:
    st.session_state["BAIDUID"] = ''
if "BDUSS_BFESS" not in st.session_state:
    st.session_state["BDUSS_BFESS"] = ''
if st.session_state["BAIDUID"] != '' and st.session_state["BDUSS_BFESS"] != '':
     fastErnie = FastErnie(st.session_state["BAIDUID"],st.session_state["BDUSS_BFESS"])


with st.container():
    st.header("gpt")
    st.markdown(f"""
    | gpt BAIDUID | gpt BDUSS_BFESS |
    | ----------- | --------------- |
    | {st.session_state["BAIDUID"]} | {st.session_state["BDUSS_BFESS"]} |
    """)


if fastErnie!='':
    with st.container():
        
        st.header("chat to gpt")
        st.markdown("运行速度可能较慢，请耐心等待！(输入/exit()退出)")
        prompt = st.text_input("Prompt",value="",max_chars=None,key=None,type="default")
        asked = st.button("Ask")
        if prompt == '/exit()':
            st.text=''
            fastErnie.close()
        else:
            if asked:
                st.text=''
                da = fastErnie.ask(prompt)
                print(da)
                    
                st.write("👨🏻 文心一言:"+da["answer"])
            
else:
    with st.container():
        st.warning("😭 please input BAIDUID and BDUSS_BFESS ❗️")
